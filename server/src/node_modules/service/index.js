const express = require('express');
const router = express.Router();
const data = require('data');

router.get('/pushes', function(req, res, next) {
  console.log('getting pushes');
  res.send(data.getPushes(open=true));
  next();
})


router.get('/pushes/:id', function(req, res, next) {
  const id = req.params.id
  console.log(`getting push details ${id}`);
  res.send(data.getPush(id));
  next();
})

router.get('/auth/:id', function(req, res, next) {
  const id = req.params.id  
  console.log(`route::authorizing ${id}`);
  const result = data.authorise(id);
  console.log(`route::authorized ${id}`);
  res.send(result);
  next();
})

module.exports = router;